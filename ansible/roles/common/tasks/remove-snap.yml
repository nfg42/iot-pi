---

- name: Remove default snaps
  community.general.snap:
    name: 
    name:
      - lxd
      - core18
      - snapd
    state: absent
    when: '"snapd" in ansible_facts.packages'

- name: Remove snapd package
  apt:
    name: snapd
    purge: yes
    state: absent

#- name: Remove useless packages from the cache
#  apt:
#    autoclean: yes
#
#- name: Remove dependencies that are no longer required
#  apt:
#    autoremove: yes

- name: Delete snap directory
  file:
    state: absent
    path: /snap

- name: Delete var snap directory
  file:
    state: absent
    path: /var/snap

- name: Delete var lib snapd directory
  file:
    state: absent
    path: /var/lib/snapd
